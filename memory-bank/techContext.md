# ペヨーテの旅路 - 技術コンテキスト

## 技術スタック

### コア技術
- **Phaser.js 3.55.2**: HTML5ゲーム開発フレームワーク
- **JavaScript (ES6+)**: コアプログラミング言語
- **HTML5/CSS3**: ブラウザ環境での実行およびスタイリング
- **WebGL**: グラフィックスレンダリング（Phaserによって抽象化）

### 補助技術
- **Git/GitHub**: バージョン管理およびコード共有
- **ピクセルアートツール**: アセット制作（具体的なツールは不明）
- **Web Audioライブラリ**: 音楽および効果音の管理（Phaserに内蔵）

## 開発環境設定

### ローカル開発
- **エディタ**: 具体的なエディタは未確認（VSCodeの可能性が高い）
- **ローカルサーバー**: おそらく`http-server`または類似のシンプルなHTTPサーバー
- **デバッグツール**: ブラウザ開発者ツール（Chrome/Firefox）

### デプロイメント
- **ホスティング**: 現状はローカル開発のみで、具体的なデプロイ先は未設定
- **配布方法**: WebブラウザベースでHTML/JS/CSSファイルの配布を前提

## 技術的制約

### ブラウザ互換性
- モダンブラウザ（Chrome, Firefox, Safari, Edge）をターゲット
- WebGLとWeb Audio APIのサポートが必要
- モバイルブラウザでのタッチ操作対応

### パフォーマンス考慮事項
- 低スペックデバイスでも動作するよう最適化が必要
- アセットサイズの管理（画像、音声ファイル）
- 多数のゲームオブジェクト（敵キャラクター）を同時に処理する必要性

### セキュリティ
- クライアントサイドのみの実装のため、機密データは保持しない
- ユーザーデータの永続化はローカルストレージのみを使用（現状は未実装）

## 依存関係

### 外部ライブラリ
- **Phaser.js**: `phaser.min.js`ファイルとして含まれている
- その他の外部依存関係はなし

### アセット依存関係
- **スプライトシート**: プレイヤーおよび敵キャラクターのアニメーション
- **背景画像**: ゲーム世界の背景
- **UI要素**: ヘルスバー、経験値バー、ボタン等
- **音楽トラック**: ゲーム内BGM（複数トラック）
- **効果音**: プレイヤーアクション、ゲームイベント用

## ツール使用パターン

### コーディングパターン
- **関数型アプローチ**: グローバル関数を中心とした設計
- **イベントリスナー**: Phaserのイベントシステムを活用
- **ゲームループ**: Phaserの`update`メソッドを使用したメインループ

### アセット管理
- プリロードフェーズでの一括読み込み
- キー名による参照システム
- スプライトシートの使用によるアニメーション管理

### デバッグ手法
- コンソールログを使用した基本的なデバッグ
- try-catchによるエラーハンドリング

## コード構成

### ファイル構造
```
/
├── index.html        # メインHTML
├── game.js           # ゲームコード全体
├── phaser.min.js     # Phaserライブラリ
└── assets/           # ゲームアセット
    ├── sprites/      # キャラクタースプライト
    ├── backgrounds/  # 背景画像
    ├── audio/        # 音楽・効果音
    └── ui/           # UI要素
```

### コードモジュール化
現在はモジュール化されておらず、単一の`game.js`ファイルに全ての機能が実装されています。以下の主要セクションが存在：

1. 初期設定とグローバル変数宣言
2. Phaserシーン定義（preload, create, update）
3. 各ゲームシステム用の関数群（プレイヤー、敵、UI等）
4. ヘルパー関数とユーティリティ

## 技術的負債と課題

### 現在の課題
1. **単一ファイル構造**: メンテナンス性と可読性の低下
2. **グローバル変数の過剰使用**: 状態管理が複雑化
3. **エラーハンドリングの不足**: 一部の機能でのみ実装
4. **ブラウザ互換性テスト**: 限られた環境でのみテスト

### 将来のリファクタリング候補
1. モジュール分割とES6モジュールの採用
2. クラスベースの設計への移行
3. ステート管理の改善
4. アセット読み込みの最適化
5. 型定義の追加（TypeScriptへの移行も検討）

### 技術的拡張の可能性
1. **オンライン機能**: マルチプレイヤー、スコアボード
2. **永続化**: プレイヤー進捗の保存
3. **モバイル最適化**: タッチコントロールの改善とレスポンシブ対応
4. **パフォーマンス向上**: オブジェクトプーリングや描画最適化 